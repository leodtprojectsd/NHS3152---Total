<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NHS31xx SW API: Sensing Component</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="nxp-logo_small.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NHS31xx SW API
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('a00414.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#groups">Modules</a> &#124;
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Sensing Component<div class="ingroups"><a class="el" href="a00424.html">Applications</a> &raquo; <a class="el" href="a00416.html">tadherence: Therapy Adherence Demo Application</a> &raquo; <a class="el" href="a00409.html">Therapy Component</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>The Therapy Adherence Demo Sensing component is responsible for providing a normalized and simplified interface to handle pill presence sensing. It is also responsible for managing the sensing circuit and configuration of the sensor(s). Its functionality is simplified down to on single API function to trigger the sensing. The application will be triggered via a callback function at the moment that an event occurs.</p>
<dl class="section user"><dt>Memory Requirements:</dt><dd>The SENSE module does not allocate any static R/W data memory. Instead, the caller should take care of the allocation of the memory required for the SENSE configuration storage.The SENSE module memory requires an Instance Buffer: The instance buffer preserves the necessary housekeeping information during an instantiation of the SENSE module. The caller must ensure that the argument pInstance passed to <a class="el" href="a00414.html#ga2915c2a78a244274a09b1fda35754bd1">Sense_SensePillRemoval</a> points to a buffer of size <a class="el" href="a00414.html#ga4d0751f11fb4f221dfdd2bda08cb9028">SENSE_INSTANCE_SIZE</a> bytes. The application is responsible to preserve this instance between 2 sense actions. </dd></dl>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="groups"></a>
Modules</h2></td></tr>
<tr class="memitem:a00415"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00415.html">Specific part for the Sensing Component</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:a00526"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00414.html#a00526">SENSE_PILL_REMOVAL_INFO_T</a></td></tr>
<tr class="separator:a00526"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga41ca3b1cc655d6f7ecab4a2894385b42"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00414.html#ga41ca3b1cc655d6f7ecab4a2894385b42">SENSE_MAX_GROUP_COUNT</a>&#160;&#160;&#160;6</td></tr>
<tr class="separator:ga41ca3b1cc655d6f7ecab4a2894385b42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4d0751f11fb4f221dfdd2bda08cb9028"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00414.html#ga4d0751f11fb4f221dfdd2bda08cb9028">SENSE_INSTANCE_SIZE</a>&#160;&#160;&#160;40</td></tr>
<tr class="separator:ga4d0751f11fb4f221dfdd2bda08cb9028"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:gaffd13e11e10c5492694d64f498e84c3b"><td class="memItemLeft" align="right" valign="top">typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00414.html#gaffd13e11e10c5492694d64f498e84c3b">Sense_RemovalCb_t</a>) (const <a class="el" href="a00414.html#a00526">SENSE_PILL_REMOVAL_INFO_T</a> *pInfo)</td></tr>
<tr class="separator:gaffd13e11e10c5492694d64f498e84c3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gafd1214618fdf9574d538506917386661"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00414.html#gafd1214618fdf9574d538506917386661">Sense_StartTherapy</a> (void *pInstance)</td></tr>
<tr class="separator:gafd1214618fdf9574d538506917386661"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2915c2a78a244274a09b1fda35754bd1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00414.html#ga2915c2a78a244274a09b1fda35754bd1">Sense_SensePillRemoval</a> (void *pInstance, <a class="el" href="a00414.html#gaffd13e11e10c5492694d64f498e84c3b">Sense_RemovalCb_t</a> cb)</td></tr>
<tr class="separator:ga2915c2a78a244274a09b1fda35754bd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<hr/><h2 class="groupheader">Data Structure Documentation</h2>
<a name="a00526" id="a00526"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00526">&#9670;&nbsp;</a></span>SENSE_PILL_REMOVAL_INFO_T</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct SENSE_PILL_REMOVAL_INFO_T</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>Structure used by the sensing component to inform the upper layer (via callback) about a pill removal </p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="ae73654f333e4363463ad8c594eca1905"></a>uint32_t</td>
<td class="fieldname">
time</td>
<td class="fielddoc">
<p>The time at which the pill was removed. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="ad4291fcb880eb5ecb178b53e32f55741"></a>uint8_t</td>
<td class="fieldname">
group</td>
<td class="fielddoc">
<p>The group containing the removed pill. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a5c587ca7f354915e9b7b67168654859f"></a>int</td>
<td class="fieldname">
initialPillCount</td>
<td class="fielddoc">
<p>The <code>group</code> 's initial pill count </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a29a8bb19a007483ebf9879929db44850"></a>bool</td>
<td class="fieldname">
positional</td>
<td class="fielddoc">
<p>Indicates whether <code>pill</code> represents an actual pill position. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="ab94b18f1e1c3700f6f0e908ac0e84c54"></a>uint32_t</td>
<td class="fieldname">
pill</td>
<td class="fielddoc">
<p>If the group is positional, bitmask indicating the removed pill. else, a right shifting bit, starting with the highest pill number. In all cases, only one bit shall be set </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ga41ca3b1cc655d6f7ecab4a2894385b42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga41ca3b1cc655d6f7ecab4a2894385b42">&#9670;&nbsp;</a></span>SENSE_MAX_GROUP_COUNT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SENSE_MAX_GROUP_COUNT&#160;&#160;&#160;6</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The maximum amount of pill groups. </p>

</div>
</div>
<a id="ga4d0751f11fb4f221dfdd2bda08cb9028"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4d0751f11fb4f221dfdd2bda08cb9028">&#9670;&nbsp;</a></span>SENSE_INSTANCE_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SENSE_INSTANCE_SIZE&#160;&#160;&#160;40</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Size of Instance buffer required by the SENSE module for internal housekeeping. </p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="gaffd13e11e10c5492694d64f498e84c3b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaffd13e11e10c5492694d64f498e84c3b">&#9670;&nbsp;</a></span>Sense_RemovalCb_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void(* Sense_RemovalCb_t) (const <a class="el" href="a00414.html#a00526">SENSE_PILL_REMOVAL_INFO_T</a> *pInfo)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Whenever an event (pill removal) is sensed, the application is notified via a callback of this prototype. It then has a chance to act accordingly. Think about updating the NDEF TEXT message and/or storing this event in non-volatile memory. This Callback can be expected during execution of (and only then) <a class="el" href="a00414.html#ga2915c2a78a244274a09b1fda35754bd1">Sense_SensePillRemoval</a>. The application is in charge of:</p><ul>
<li>reading the information from the returned memory location</li>
<li>hard coping this information if it needs to be preserved</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pInfo</td><td>: pointer to the info about the pill removal which is the subject of the callback. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="gafd1214618fdf9574d538506917386661"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gafd1214618fdf9574d538506917386661">&#9670;&nbsp;</a></span>Sense_StartTherapy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Sense_StartTherapy </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>pInstance</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function initialize the module for a new therapy. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pInstance</td><td>: pointer to ram location where to store internal data, this buffer needs to be of size <a class="el" href="a00414.html#ga4d0751f11fb4f221dfdd2bda08cb9028">SENSE_INSTANCE_SIZE</a>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Number of pills remaining for the started therapy </dd></dl>

</div>
</div>
<a id="ga2915c2a78a244274a09b1fda35754bd1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2915c2a78a244274a09b1fda35754bd1">&#9670;&nbsp;</a></span>Sense_SensePillRemoval()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Sense_SensePillRemoval </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>pInstance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00414.html#gaffd13e11e10c5492694d64f498e84c3b">Sense_RemovalCb_t</a>&#160;</td>
          <td class="paramname"><em>cb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function will sense all pill groups, if a difference is observed between the newly sensed pill removals and the previous (stored in pInstance), <code>SENSE_CB</code> is called to inform the higher levels about new event(s). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pInstance</td><td>: Base address of instance Buffer. The instance buffer preserves the necessary housekeeping information during an instantiation of the SENSE module. The caller must ensure that the argument pInstance points to a buffer of size <a class="el" href="a00414.html#ga4d0751f11fb4f221dfdd2bda08cb9028">SENSE_INSTANCE_SIZE</a> bytes. </td></tr>
    <tr><td class="paramname">cb</td><td>: A function pointer to a callback, this will be called for every new pill removal recorded. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Number of pills left </dd></dl>
<dl class="section note"><dt>Note</dt><dd><code>SENSE_CB</code> will be called if new pill removal is observed. </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Tue Oct 20 2020 08:24:34 for NHS31xx SW API by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
