<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NHS31xx SW API: flash: Flash driver</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="nxp-logo_small.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NHS31xx SW API
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('a00451.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">flash: Flash driver<div class="ingroups"><a class="el" href="a00427.html">Drivers</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>The Flash driver provides APIs to select the power mode that the flash memory operates in, and the number of wait states to apply to flash operations. </p><dl class="section note"><dt>Note</dt><dd>Please note that this API provides only a small part of the features.</dd></dl>
<dl class="section user"><dt>Flash Power Modes</dt><dd>The flash memory on the chip supports two power modes:<ul>
<li>low power mode</li>
<li>high power mode <br />
 High power mode may be required for some flash operations, please refer to the user manual for details.</li>
</ul>
</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Directly accessing Flash controller addresses (<a class="el" href="a00451.html#a00630">NSS_FLASH_T</a>) when the Flash clock is disabled blocks the APB bus indefinitely.</dd></dl>
<dl class="section user"><dt>Wait States</dt><dd>To manage the flash memory read operation in low power mode, it may be necessary - dependent on the the system clock frequency - to wait for some number of extra system clocks, which is also called wait states. Please refer to the user manual for more details. For a full list of clock restrictions in effect, see <a class="el" href="a00767.html">SW Clock Restrictions</a>.</dd></dl>
<dl class="section user"><dt>Erasing/Writing</dt><dd>For flash erasing and writing, please refer to <a class="el" href="a00455.html">iap: In Application Programming driver</a>.</dd></dl>
<dl class="section user"><dt>Example - Switching between flash modes:</dt><dd>Assume a controller that normally runs at 0.5MHz, but it can also run at 8MHz. When running on 8MHz, the flash should be either in high power mode(1), or in low power mode with extra wait states(2).<ol type="1">
<li>Switch to 8MHz in low power mode with extra wait states <div class="fragment"><div class="line">    <a class="code" href="a00451.html#gacae6dfe817bf6354feb90656a578ae8d">Chip_Flash_SetHighPowerMode</a>(<span class="keyword">false</span>);</div><div class="line">    <a class="code" href="a00451.html#gab33d41bc84dc1175a6454d6dc994d9e5">Chip_Flash_SetNumWaitStates</a>(1);</div><div class="line">    <a class="code" href="a00434.html#ga8de42eae27a7e7c300f1f57da9e56bb2">Chip_Clock_System_SetClockFreq</a>(8 * 1000 * 1000);</div></div><!-- fragment --></li>
<li>Switch to 8MHz in high power mode without extra wait states <div class="fragment"><div class="line">    <a class="code" href="a00451.html#gacae6dfe817bf6354feb90656a578ae8d">Chip_Flash_SetHighPowerMode</a>(<span class="keyword">true</span>);</div><div class="line">    <a class="code" href="a00451.html#gab33d41bc84dc1175a6454d6dc994d9e5">Chip_Flash_SetNumWaitStates</a>(0);</div><div class="line">    <a class="code" href="a00434.html#ga8de42eae27a7e7c300f1f57da9e56bb2">Chip_Clock_System_SetClockFreq</a>(8 * 1000 * 1000);</div></div><!-- fragment --></li>
</ol>
</dd></dl>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:a00630"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00451.html#a00630">NSS_FLASH_T</a></td></tr>
<tr class="separator:a00630"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gacae6dfe817bf6354feb90656a578ae8d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00451.html#gacae6dfe817bf6354feb90656a578ae8d">Chip_Flash_SetHighPowerMode</a> (bool highPower)</td></tr>
<tr class="separator:gacae6dfe817bf6354feb90656a578ae8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf766280b94fe3daf9cf9dc6bdb72e554"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00451.html#gaf766280b94fe3daf9cf9dc6bdb72e554">Chip_Flash_GetHighPowerMode</a> (void)</td></tr>
<tr class="separator:gaf766280b94fe3daf9cf9dc6bdb72e554"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab33d41bc84dc1175a6454d6dc994d9e5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00451.html#gab33d41bc84dc1175a6454d6dc994d9e5">Chip_Flash_SetNumWaitStates</a> (int waitStates)</td></tr>
<tr class="separator:gab33d41bc84dc1175a6454d6dc994d9e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaab094977927f52de77522abc3e783056"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00451.html#gaab094977927f52de77522abc3e783056">Chip_Flash_GetNumWaitStates</a> (void)</td></tr>
<tr class="separator:gaab094977927f52de77522abc3e783056"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<hr/><h2 class="groupheader">Data Structure Documentation</h2>
<a name="a00630" id="a00630"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00630">&#9670;&nbsp;</a></span>NSS_FLASH_T</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct NSS_FLASH_T</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>NSS Flash register block structure </p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="abdf2590f5a7503353e649260f443ae11"></a><a class="el" href="a00437.html#gaec43007d9998a0a0e01faede4133d6be">__IO</a> uint32_t</td>
<td class="fieldname">
FCTR</td>
<td class="fielddoc">
<p>Flash control register </p>
</td></tr>
<tr><td class="fieldtype">
<a id="aaf574ecbb07fc7a9197d4e31cbdc6843"></a><a class="el" href="a00437.html#gaf63697ed9952cc71e1225efe205f6cd3">__I</a> uint32_t</td>
<td class="fieldname">
FSTAT</td>
<td class="fielddoc">
<p>Flash status register </p>
</td></tr>
<tr><td class="fieldtype">
<a id="ab7682c1313179c007ba109618cdfd25e"></a><a class="el" href="a00437.html#gaec43007d9998a0a0e01faede4133d6be">__IO</a> uint32_t</td>
<td class="fieldname">
FPTR</td>
<td class="fielddoc">
<p>Flash program-time register </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a39fbdbb7ad559315fa9c23de59936655"></a><a class="el" href="a00437.html#gaf63697ed9952cc71e1225efe205f6cd3">__I</a> uint32_t</td>
<td class="fieldname">
RESERVED1</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a36abaa2e056166597261b80f51711809"></a><a class="el" href="a00437.html#gaec43007d9998a0a0e01faede4133d6be">__IO</a> uint32_t</td>
<td class="fieldname">
FBWST</td>
<td class="fielddoc">
<p>Flash wait state register </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a9c89d8514e7f2732c6cb573cd4602af2"></a><a class="el" href="a00437.html#gaf63697ed9952cc71e1225efe205f6cd3">__I</a> uint32_t</td>
<td class="fieldname">
RESERVED2[2]</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="abb1d4d6de60128312100b131e2398850"></a><a class="el" href="a00437.html#gaec43007d9998a0a0e01faede4133d6be">__IO</a> uint32_t</td>
<td class="fieldname">
FCRA</td>
<td class="fielddoc">
<p>Flash program clock divider </p>
</td></tr>
<tr><td class="fieldtype">
<a id="afd931464b936767753c74cd28bb583b3"></a><a class="el" href="a00437.html#gaec43007d9998a0a0e01faede4133d6be">__IO</a> uint32_t</td>
<td class="fieldname">
FMSSTART</td>
<td class="fielddoc">
<p>Flash checksum start address register </p>
</td></tr>
<tr><td class="fieldtype">
<a id="af1e4121d1502bf5d3b8503f870cd298a"></a><a class="el" href="a00437.html#gaec43007d9998a0a0e01faede4133d6be">__IO</a> uint32_t</td>
<td class="fieldname">
FMSSTOP</td>
<td class="fielddoc">
<p>Flash checksum stop address register </p>
</td></tr>
<tr><td class="fieldtype">
<a id="aa1d62d18cea763d8c58c2457803c134c"></a><a class="el" href="a00437.html#gaf63697ed9952cc71e1225efe205f6cd3">__I</a> uint32_t</td>
<td class="fieldname">
FMS16</td>
<td class="fielddoc">
<p>Flash parity signature register </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a314027bebe2cb9367de0106190eaf96e"></a><a class="el" href="a00437.html#gaf63697ed9952cc71e1225efe205f6cd3">__I</a> uint32_t</td>
<td class="fieldname">
FMSW0</td>
<td class="fielddoc">
<p>Flash data signature register </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a7a2207b245583e6072ba6c7917b37059"></a><a class="el" href="a00437.html#gaf63697ed9952cc71e1225efe205f6cd3">__I</a> uint32_t</td>
<td class="fieldname">
RESERVED3[8]</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a00619fd5120461cd812e3c19201dc976"></a><a class="el" href="a00437.html#gaec43007d9998a0a0e01faede4133d6be">__IO</a> uint32_t</td>
<td class="fieldname">
ECCRSTERRCNT</td>
<td class="fielddoc">
<p>Invalid flag and error corrected counter reset </p>
</td></tr>
<tr><td class="fieldtype">
<a id="afe596acbdfa6fc11b6f5139ad720efa0"></a><a class="el" href="a00437.html#gaf63697ed9952cc71e1225efe205f6cd3">__I</a> uint32_t</td>
<td class="fieldname">
ECCERRCNT</td>
<td class="fielddoc">
<p>ECC status information </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a40476077a199861724cf968ad323b6fe"></a><a class="el" href="a00437.html#gaf63697ed9952cc71e1225efe205f6cd3">__I</a> uint32_t</td>
<td class="fieldname">
RESERVED4[990]</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="af5c342b27916945ebff929c7c617806b"></a><a class="el" href="a00437.html#gaf63697ed9952cc71e1225efe205f6cd3">__I</a> uint32_t</td>
<td class="fieldname">
MODULE_CONFIG</td>
<td class="fielddoc">
<p>Controller configuration options </p>
</td></tr>
<tr><td class="fieldtype">
<a id="aa83bddd1f180bafbb96085399f847cd7"></a><a class="el" href="a00437.html#gaf63697ed9952cc71e1225efe205f6cd3">__I</a> uint32_t</td>
<td class="fieldname">
RESERVED5</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a26f35bd1f079b2181289909ae36c5b8c"></a><a class="el" href="a00437.html#ga7e25d9380f9ef903923964322e71f2f6">__O</a> uint32_t</td>
<td class="fieldname">
INT_CLR_ENABLE</td>
<td class="fielddoc">
<p>Clear interrupt enable bits </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a672190d04cdbee469e4ca4ac00287b1c"></a><a class="el" href="a00437.html#ga7e25d9380f9ef903923964322e71f2f6">__O</a> uint32_t</td>
<td class="fieldname">
INT_SET_ENABLE</td>
<td class="fielddoc">
<p>Set interrupt enable bits </p>
</td></tr>
<tr><td class="fieldtype">
<a id="aa42cc3870497afd949307e35022f63ce"></a><a class="el" href="a00437.html#gaf63697ed9952cc71e1225efe205f6cd3">__I</a> uint32_t</td>
<td class="fieldname">
INT_STATUS</td>
<td class="fielddoc">
<p>Interrupt status bits </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a82befad617e566aeb55bb01b3859404c"></a><a class="el" href="a00437.html#gaf63697ed9952cc71e1225efe205f6cd3">__I</a> uint32_t</td>
<td class="fieldname">
INT_ENABLE</td>
<td class="fielddoc">
<p>Interrupt enable bits </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a0a204a5a314c83e483a38407a119deb3"></a><a class="el" href="a00437.html#ga7e25d9380f9ef903923964322e71f2f6">__O</a> uint32_t</td>
<td class="fieldname">
INT_CLR_STATUS</td>
<td class="fielddoc">
<p>Clear interrupt status bits </p>
</td></tr>
<tr><td class="fieldtype">
<a id="ac83305253ab5c44c95e9099bf4d87d8d"></a><a class="el" href="a00437.html#ga7e25d9380f9ef903923964322e71f2f6">__O</a> uint32_t</td>
<td class="fieldname">
INT_SET_STATUS</td>
<td class="fielddoc">
<p>Set interrupt status bits </p>
</td></tr>
<tr><td class="fieldtype">
<a id="ac86c9fd5eea7fb45154c517eb3e5b15c"></a><a class="el" href="a00437.html#gaf63697ed9952cc71e1225efe205f6cd3">__I</a> uint32_t</td>
<td class="fieldname">
RESERVED6[3]</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a311bb1f9d410c1ef75d7af93253190a6"></a><a class="el" href="a00437.html#gaf63697ed9952cc71e1225efe205f6cd3">__I</a> uint32_t</td>
<td class="fieldname">
MODULE_ID</td>
<td class="fielddoc">
<p>Controller memory module identification </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="gacae6dfe817bf6354feb90656a578ae8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gacae6dfe817bf6354feb90656a578ae8d">&#9670;&nbsp;</a></span>Chip_Flash_SetHighPowerMode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Chip_Flash_SetHighPowerMode </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>highPower</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Sets the power mode of the flash memory. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">highPower</td><td>: True for high power mode, false for low power mode </td></tr>
  </table>
  </dd>
</dl>
<dl class="section pre"><dt>Precondition</dt><dd>If <code>highPower</code> equals <code>false</code>, the caller must ensure that either<ul>
<li>flash wait states is set to 1 or higher, or</li>
<li>system clock divisor is not 1 - by calling <a class="el" href="a00434.html#ga8de42eae27a7e7c300f1f57da9e56bb2">Chip_Clock_System_SetClockFreq</a> with argument <code>4000000</code> or less.</li>
</ul>
Failure to do so will result in a hard fault (flash access error). See also <a class="el" href="a00767.html">SW Clock Restrictions</a> </dd></dl>

</div>
</div>
<a id="gaf766280b94fe3daf9cf9dc6bdb72e554"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf766280b94fe3daf9cf9dc6bdb72e554">&#9670;&nbsp;</a></span>Chip_Flash_GetHighPowerMode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Chip_Flash_GetHighPowerMode </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Gets the power mode of the flash memory. </p><dl class="section return"><dt>Returns</dt><dd>True if the flash memory operates in high power mode, false otherwise. </dd></dl>

</div>
</div>
<a id="gab33d41bc84dc1175a6454d6dc994d9e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab33d41bc84dc1175a6454d6dc994d9e5">&#9670;&nbsp;</a></span>Chip_Flash_SetNumWaitStates()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Chip_Flash_SetNumWaitStates </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>waitStates</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Sets the number of wait states for flash operations. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">waitStates</td><td>: Number of wait states to be added to flash operations. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section pre"><dt>Precondition</dt><dd>If <code>waitStates</code> equals <code>0</code>, the caller must ensure that either<ul>
<li>high power mode is configured - <a class="el" href="a00451.html#gacae6dfe817bf6354feb90656a578ae8d">Chip_Flash_SetHighPowerMode</a> with argument <code>true</code>, or</li>
<li>system clock divisor is not 1 - by calling <a class="el" href="a00434.html#ga8de42eae27a7e7c300f1f57da9e56bb2">Chip_Clock_System_SetClockFreq</a> with argument <code>4000000</code> or less.</li>
</ul>
Failure to do so will result in a hard fault (flash access error). See also <a class="el" href="a00767.html">SW Clock Restrictions</a> </dd></dl>

</div>
</div>
<a id="gaab094977927f52de77522abc3e783056"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaab094977927f52de77522abc3e783056">&#9670;&nbsp;</a></span>Chip_Flash_GetNumWaitStates()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Chip_Flash_GetNumWaitStates </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Gets the number of wait states applied to flasAh operations. </p><dl class="section return"><dt>Returns</dt><dd>The number of wait states that are currently applied to flash operations. </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Tue Oct 20 2020 08:24:34 for NHS31xx SW API by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
